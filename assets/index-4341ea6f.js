import{r as c,j as o,R as l}from"./react-76f7fb99.js";import{c as d}from"./react-dom-e44ba450.js";import"./@tensorflow-4a9c595e.js";import{d as u,T as f,l as p}from"./face-api.js-a34ad70b.js";import{G as m}from"./react-github-btn-5c4c3b9f.js";import"./scheduler-765c72db.js";import"./tslib-890ecb0d.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function a(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(e){if(e.ep)return;e.ep=!0;const s=a(e);fetch(e.href,s)}})();const g=({onStream:r})=>{const n=c.useRef(!1),a=c.useRef(null),t=c.useCallback(async e=>{if(!r)return;await r(e)===!0&&t(e)},[r]);return c.useEffect(()=>{a.current&&!n.current&&(navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:""}}).then(e=>{a.current&&(a.current.srcObject=e)}),n.current=!0)},[t]),o.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,onPlay:e=>t(e.target),style:{position:"fixed",opacity:0,top:0,left:0}})},h="/3d-object/assets/astronaut-be2fa186.png",b=({angle:r})=>{const a=(r.x-50)/100*20,t=(r.x-50)/100*70,e=0,s=0,i=(r.x-50)/100*5;return o.jsx("div",{className:"card-container",style:{display:"grid",placeItems:"center",perspective:600},children:o.jsx("div",{className:"card",style:{position:"relative",width:300,maxWidth:300,height:300,borderRadius:150,background:`linear-gradient(
            rgba(250, 250, 250, 0.2),
            rgba(0, 0, 0, 0.3)
          `,boxShadow:"0 0 100px #000",backdropFilter:"blur(4px)",transform:`
            rotateY(${t}deg)
            rotateX(${e}deg)
            translateX(${a}%)
            translateY(0%)
          `,transition:"transform 0.1s ease-in-out"},children:o.jsx("img",{className:"astronaut",style:{position:"absolute",width:"100%",height:"100%",objectFit:"contain",transform:`
              translateX(${i}%)
              translateY(${s}%)
            `,transition:"transform 0.2s ease-in-out"},src:h})})})},x="/3d-object/assets/background-a4ea1b11.jpg",y=({angle:r})=>{const a=(r.x-50)/100*20,t=(r.x-50)/100*30,e=0;return o.jsx("img",{className:"background",style:{position:"absolute",top:"-10%",left:"-10%",width:"120%",height:"120%",objectFit:"cover",perspective:600,transform:`
          translateX(${a}%)
          translateY(0%)
          rotateX(${e}deg)
          rotateY(${t}deg)
        `,filter:"blur(1px)",transition:"transform 0.1s ease-in-out"},src:x})},j=({name:r,children:n})=>{const a=c.useRef(!1),[t,e]=c.useState();c.useEffect(()=>{a.current||(a.current=!0,(async()=>{try{const i=await navigator.permissions.query({name:r});e(i),i.onchange=()=>{e(i)}}catch{}})())},[a,r,e]);const s=c.useCallback(()=>navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:""}}),[]);return c.useEffect(()=>{(t==null?void 0:t.state)==="prompt"&&confirm(`The ${r} permission is needed.`)&&s().then(()=>window.location.reload()),(t==null?void 0:t.state)==="denied"&&alert(`This app will not works without ${r} permission. Please give this permission via browser.`)},[s,r,t]),(t==null?void 0:t.state)==="granted"&&n};function v(){const[r,n]=c.useState({x:50,y:20}),a=c.useCallback(async t=>{const e=await u(t,new f({scoreThreshold:.5,inputSize:128}));return e!=null&&e.box&&(n({x:(e.box.x+e.box.width/2)/e.imageWidth*100,y:(e.box.y+e.box.height/2)/e.imageHeight*100}),await new Promise(s=>requestAnimationFrame(s))),!0},[]);return o.jsxs("div",{style:{display:"grid",placeItems:"center",position:"relative",height:"100%",width:"100%",background:"cyan"},children:[o.jsx(y,{angle:r}),o.jsx(b,{angle:r}),o.jsx(j,{name:"camera",children:o.jsx(g,{onStream:a})}),o.jsx("div",{style:{position:"fixed",bottom:15,right:15},children:o.jsx(m,{href:"https://github.com/nainemom/3d-object","data-size":"large","data-show-count":"true","aria-label":"Star nainemom/3d-object on GitHub",children:"Star"})})]})}const w=async()=>{await p("./models"),d(document.getElementById("root")).render(o.jsx(l.StrictMode,{children:o.jsx(v,{})}))};w();
