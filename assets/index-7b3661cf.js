import{r as a,j as r,R as d}from"./react-1d8b2501.js";import{c as m}from"./react-dom-8f395115.js";import"./@tensorflow-4a9c595e.js";import{d as p,T as f,l as h}from"./face-api.js-a34ad70b.js";import{G as x}from"./react-github-btn-6085e282.js";import{u as g,S as y,C as j,E as b,O as v}from"./@react-three-eef34b37.js";import"./@chevrotain-39b5b250.js";import"./scheduler-765c72db.js";import"./tslib-890ecb0d.js";import"./@babel-98964cd2.js";import"./three-8b24794f.js";import"./react-use-measure-d29e657e.js";import"./debounce-6284fd2f.js";import"./its-fine-1bc6d9bc.js";import"./react-reconciler-9b028127.js";import"./three-stdlib-d90b4a76.js";import"./fflate-dcdcf726.js";import"./suspend-react-00b64780.js";import"./zustand-b2af9d58.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(e){if(e.ep)return;e.ep=!0;const i=o(e);fetch(e.href,i)}})();const u=a.createContext(void 0),S=({children:s})=>{const[t,o]=a.useState(),n=a.useCallback(()=>{t!=null&&t.active||navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:""}}).then(o).catch(()=>{alert("TPlease give this permission via website setting in your browser.")})},[t,o]);return r.jsx(u.Provider,{value:t,children:t!=null&&t.active?s:r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("h2",{style:{marginBottom:8},children:"This app needs camera permission."}),r.jsx("button",{style:{padding:4},onClick:n,children:" Allow Access "})]})})},w=()=>a.useContext(u),A=({onStream:s})=>{const t=a.useRef(null),o=w(),n=a.useCallback(async e=>{if(!s)return;await s(e)===!0&&n(e)},[s]);return a.useEffect(()=>{!(o!=null&&o.active)||!t.current||(t.current.srcObject=o)},[o,t]),(o==null?void 0:o.active)&&r.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,onPlay:e=>n(e.target),style:{position:"fixed",opacity:0,top:0,left:0,pointerEvents:"none"}})},P=s=>{const t=a.useRef(null);return g((o,n)=>{var e;(e=t.current)!=null&&e.rotation&&(t.current.rotation.y+=n/8)}),r.jsxs("mesh",{...s,position:[1,2,-1],ref:t,children:[r.jsx("boxGeometry",{args:[2,2,2]}),r.jsx("meshPhysicalMaterial",{roughness:-.1,color:"rgba(0, 0, 0, 0.2)",envMapIntensity:1}),r.jsx(y,{rotation:[0,0,0],scale:6,position:[0,-2,0],color:"black",opacity:.6})]})},C=({angle:s})=>{const t=a.useRef();return a.useEffect(()=>{var o,n,e,i,c,l;(n=(o=t.current)==null?void 0:o.setAzimuthalAngle)==null||n.call(o,s.x*-1/100),(i=(e=t.current)==null?void 0:e.setPolarAngle)==null||i.call(e,.5+s.y/100),(l=(c=t.current)==null?void 0:c.update)==null||l.call(c)},[s]),r.jsx(r.Fragment,{children:r.jsxs(j,{children:[r.jsx(b,{files:"https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/2k/evening_road_01_2k.hdr",ground:{height:5,radius:40,scale:30}}),r.jsx(P,{}),r.jsx(v,{minDistance:8,maxDistance:8,minPolarAngle:.5,maxPolarAngle:1.5,ref:t})]})})};function O(){const[s,t]=a.useState({x:50,y:20}),o=a.useCallback(async n=>{const e=await p(n,new f({scoreThreshold:.5,inputSize:128}));return e!=null&&e.box&&(t({x:(e.box.x+e.box.width/2)/e.imageWidth*100,y:(e.box.y+e.box.height/2)/e.imageHeight*100}),await new Promise(i=>requestAnimationFrame(i))),!0},[]);return r.jsxs("div",{style:{display:"grid",placeItems:"center",position:"relative",height:"100%",width:"100%"},children:[r.jsxs(S,{children:[r.jsx(C,{angle:s}),r.jsx(A,{onStream:o})]}),r.jsx("div",{style:{position:"fixed",bottom:15,right:15},children:r.jsx(x,{href:"https://github.com/nainemom/3d-object","data-size":"large","data-show-count":"true","aria-label":"Star nainemom/3d-object on GitHub",children:"Star"})})]})}const E=async()=>{const s=document.querySelector("#root");await h("./models"),m(s).render(r.jsx(d.StrictMode,{children:r.jsx(O,{})}))};E();
